parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"TjAK":[function(require,module,exports) {
function t(a){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}window.Whammy=function(){function a(t,a){for(var e,i=function(t){for(var a=t[0].width,e=t[0].height,i=t[0].duration,r=1;r<t.length;r++){if(t[r].width!=a)throw"Frame ".concat(r+1," has a different width");if(t[r].height!=e)throw"Frame ".concat(r+1," has a different height");if(t[r].duration<0||t[r].duration>32767)throw"Frame ".concat(r+1," has a weird duration (must be between 0 and 32767)");i+=t[r].duration}return{duration:i,width:a,height:e}}(t),r=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(e=i.duration,[].slice.call(new Uint8Array(new Float64Array([e]).buffer),0).map(function(t){return String.fromCharCode(t)}).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:i.width,id:176},{data:i.height,id:186}]}]}]},{id:475249515,data:[]}]}],n=r[1],u=n.data[2],h=0,s=0;h<t.length;){var f={id:187,data:[{data:Math.round(s),id:179},{id:183,data:[{data:1,id:247},{data:0,size:8,id:241}]}]};u.data.push(f);var c=[],m=0;do{c.push(t[h]),m+=t[h].duration,h++}while(h<t.length&&m<3e4);var g=0,l={id:524531317,data:[{data:Math.round(s),id:231}].concat(c.map(function(t){var a=d({discardable:0,frame:t.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(g)});return g+=t.duration,{data:a,id:163}}))};n.data.push(l),s+=m}for(var p=0,y=0;y<n.data.length;y++){y>=3&&(u.data[y-3].data[1].data[1].data=p);var v=o([n.data[y]],a);p+=v.size||v.byteLength||v.length,2!=y&&(n.data[y]=v)}return o(r,a)}function e(t){for(var a=[];t>0;)a.push(255&t),t>>=8;return new Uint8Array(a.reverse())}function i(t,a){for(var e=new Uint8Array(a),i=a-1;i>=0;i--)e[i]=255&t,t>>=8;return e}function r(t){for(var a=new Uint8Array(t.length),e=0;e<t.length;e++)a[e]=t.charCodeAt(e);return a}function n(t){var a=[];t=(t.length%8?new Array(9-t.length%8).join("0"):"")+t;for(var e=0;e<t.length;e+=8)a.push(parseInt(t.substr(e,8),2));return new Uint8Array(a)}function o(a,d){for(var u=[],h=0;h<a.length;h++)if("id"in a[h]){var s=a[h].data;if("object"===t(s)&&(s=o(s,d)),"number"==typeof s&&(s="size"in a[h]?i(s,a[h].size):n(s.toString(2))),"string"==typeof s&&(s=r(s)),s.length);var f=s.size||s.byteLength||s.length,c=Math.ceil(Math.ceil(Math.log(f)/Math.log(2))/8),m=f.toString(2),g=new Array(7*c+7+1-m.length).join("0")+m,l="".concat(new Array(c).join("0"),"1").concat(g);u.push(e(a[h].id)),u.push(n(l)),u.push(s)}else u.push(a[h]);if(d){var p=function a(e,i){null==i&&(i=[]);for(var r=0;r<e.length;r++)"object"===t(e[r])?a(e[r],i):i.push(e[r]);return i}(u);return new Uint8Array(p)}return new Blob(u,{type:"video/webm"})}function d(t){var a=0;if(t.keyframe&&(a|=128),t.invisible&&(a|=8),t.lacing&&(a|=t.lacing<<1),t.discardable&&(a|=1),t.trackNum>127)throw"TrackNumber > 127 not supported";return[128|t.trackNum,t.timecode>>8,255&t.timecode,a].map(function(t){return String.fromCharCode(t)}).join("")+t.frame}function u(t){for(var a,e,i=t.RIFF[0].WEBP[0],r=i.indexOf("¬ù*"),n=0,o=[];n<4;n++)o[n]=i.charCodeAt(r+3+n);return a=16383&(e=o[1]<<8|o[0]),e>>14,(e=o[3]<<8|o[2])>>14,{width:a,height:16383&e,data:i,riff:t}}function h(t){for(var a=0,e={};a<t.length;){var i=t.substr(a,4);if(e[i]=e[i]||[],"RIFF"==i||"LIST"==i){var r=parseInt(t.substr(a+4,4).split("").map(function(t){var a=t.charCodeAt(0).toString(2);return new Array(8-a.length+1).join("0")+a}).join(""),2),n=t.substr(a+4+4,r);a+=8+r,e[i].push(h(n))}else"WEBP"==i?(e[i].push(t.substr(a+8)),a=t.length):(e[i].push(t.substr(a+4)),a=t.length)}return e}function s(t,a){this.frames=[],this.duration=1e3/t,this.quality=a||.8}return s.prototype.add=function(t,a){if(void 0!==a&&this.duration)throw"you can't pass a duration if the fps is set";if(void 0===a&&!this.duration)throw"if you don't have the fps set, you need to have durations here.";if(t.canvas&&(t=t.canvas),t.toDataURL)t=t.getContext("2d").getImageData(0,0,t.width,t.height);else if("string"!=typeof t)throw"frame must be a a HTMLCanvasElement, a CanvasRenderingContext2D or a DataURI formatted string";if("string"==typeof t&&!/^data:image\/webp;base64,/gi.test(t))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:t,duration:a||this.duration})},s.prototype.encodeFrames=function(t){if(this.frames[0].image instanceof ImageData){var a=this.frames,e=document.createElement("canvas"),i=e.getContext("2d");e.width=this.frames[0].image.width,e.height=this.frames[0].image.height;var r=function(n){console.log("encodeFrame",n);var o=a[n];i.putImageData(o.image,0,0),o.image=e.toDataURL("image/webp",this.quality),n<a.length-1?setTimeout(function(){r(n+1)},1):t()}.bind(this);r(0)}else t()},s.prototype.compile=function(t,e){this.encodeFrames(function(){var i=new a(this.frames.map(function(t){var a=u(h(atob(t.image.slice(23))));return a.duration=t.duration,a}),t);e(i)}.bind(this))},{Video:s,fromImageArray:function(t,e,i){return a(t.map(function(t){var a=u(h(atob(t.slice(23))));return a.duration=1e3/e,a}),i)},toWebM:a}}();
},{}]},{},["TjAK"], null)
//# sourceMappingURL=whammy.77c87d28.js.map